<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../paper-dropdown-menu/paper-dropdown-menu.html">
<link rel="import" href="../paper-item/paper-item.html">
<link rel="import" href="../paper-listbox/paper-listbox.html">
<link rel="import" href="./mtz-lang-trans.html">
<link rel="import" href="./mtz-login.html">
<link rel="import" href="./mtz-lang-trans.html">
<link rel="import" href="./mtz-logout-behavior.html">

<dom-module id="demo-login-page">
  <template>
    <mtz-login login-url="http://localhost:8081/rest/login"></mtz-login>
    <div>
      <paper-button raised on-click="logout">[[logoutLabelT]]</paper-button>
    </div>
    <div>
      <!--paper-dropdown-menu label="Language" selected-item-label="{{selectedLanguage}}"-->
      <paper-dropdown-menu label="Language" selected-item="{{selectedLanguage}}">
        <paper-listbox class="dropdown-content"
          selected=[[languageIndex]]>
          <paper-item value="en">English</paper-item>
          <paper-item value="es">Español</paper-item>
          <paper-item value="fr">Français</paper-item>
        </paper-listbox>
      </paper-dropdown-menu>
    </div>
  </template>
  <script>
    Polymer({
      is: 'demo-login-page',
      behaviors: [MtzLangTrans, MtzLogoutBehavior],
      properties: {
        languageIndex: Number,
        logoutLabelT: String,
        logoutUrl: {
          type: String,
          value: 'http://localhost:8081/rest/logout'
        },
        selectedLanguage: {
          type: Object,
          observer: '_changeLanguage'
        }
      },
      ready() {
        const languages = ['en', 'es', 'fr'];
        this.languageIndex = 0;
        this.setLanguage(languages[this.languageIndex]);

        const keys = ['Logout'];
        this.getTranslations(keys,
          translations => this.logoutLabelT = translations.Logout);
      },
      _changeLanguage(paperItemElement) {
        if (!paperItemElement) return; // Why does this happen?
        const lang = paperItemElement.getAttribute('value');
        console.log('demo-login-page.html _changeLanguage: lang =', lang);
        this.setLanguage(lang);
      }
    });
  </script>
</dom-module>
